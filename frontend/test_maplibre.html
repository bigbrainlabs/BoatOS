<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>MapLibre GL Leaflet Test</title>
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css"/>
    <link rel="stylesheet" href="https://unpkg.com/maplibre-gl@4.7.1/dist/maplibre-gl.css"/>
    <style>
        body { margin: 0; padding: 0; }
        #map { position: absolute; top: 0; bottom: 0; width: 100%; }
        #info {
            position: absolute;
            top: 10px;
            left: 10px;
            background: white;
            padding: 10px;
            border-radius: 5px;
            z-index: 1000;
            font-family: sans-serif;
        }
        .status { margin: 5px 0; }
        .success { color: green; }
        .error { color: red; }
    </style>
</head>
<body>
    <div id="info">
        <h3>MapLibre GL Leaflet Test</h3>
        <div class="status" id="leaflet-status">Leaflet: Loading...</div>
        <div class="status" id="maplibre-status">MapLibre GL: Loading...</div>
        <div class="status" id="plugin-status">Plugin: Loading...</div>
        <div class="status" id="map-status">Map: Initializing...</div>
    </div>
    <div id="map"></div>

    <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>
    <script src="https://unpkg.com/maplibre-gl@4.7.1/dist/maplibre-gl.js"></script>
    <script src="https://unpkg.com/@maplibre/maplibre-gl-leaflet@0.0.20/leaflet-maplibre-gl.js"></script>
    <script>
        // Check if libraries loaded
        document.getElementById('leaflet-status').innerHTML =
            typeof L !== 'undefined' ?
            '<span class="success">✓ Leaflet: Loaded</span>' :
            '<span class="error">✗ Leaflet: Failed</span>';

        document.getElementById('maplibre-status').innerHTML =
            typeof maplibregl !== 'undefined' ?
            '<span class="success">✓ MapLibre GL: Loaded</span>' :
            '<span class="error">✗ MapLibre GL: Failed</span>';

        document.getElementById('plugin-status').innerHTML =
            typeof L.maplibreGL !== 'undefined' ?
            '<span class="success">✓ Plugin: Loaded</span>' :
            '<span class="error">✗ Plugin: Failed</span>';

        // Initialize map
        try {
            // Default position (Germany - Rhine area)
            const defaultLat = 50.9413;
            const defaultLon = 6.9583;

            var map = L.map('map').setView([defaultLat, defaultLon], 13);

            // Create MapLibre GL layer
            var glLayer = L.maplibreGL({
                style: '/tiles/styles/basic/style.json',
                attribution: '© OpenStreetMap'
            });

            // Add layer to map
            glLayer.addTo(map);

            // Add a test marker
            L.marker([defaultLat, defaultLon])
                .addTo(map)
                .bindPopup('Test Marker - MapLibre GL works!');

            document.getElementById('map-status').innerHTML =
                '<span class="success">✓ Map: Initialized successfully!</span>';

            // Log map center and zoom
            console.log('Map initialized at:', map.getCenter(), 'Zoom:', map.getZoom());
        } catch (error) {
            document.getElementById('map-status').innerHTML =
                '<span class="error">✗ Map: Error - ' + error.message + '</span>';
            console.error('Map initialization error:', error);
        }
    </script>
</body>
</html>
